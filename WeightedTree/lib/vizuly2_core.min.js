/*! Vizuly2 01-03-2019 */
(function (global, factory) {  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :  typeof define === 'function' && define.amd ? define(['exports'], factory) : 	(factory((global.vizuly2 = global.vizuly2 || {})));  } (this, (function (exports) { 'use strict';
var vizuly2={version:"2.2.78",loadD3:function(t){vizuly2.d3=t}};void 0!==window.d3v4?vizuly2.d3=window.d3v4:"undefined"!=typeof d3?vizuly2.d3=d3:void 0!==window.d3&&(vizuly2.d3=window.d3),vizuly2.d3?Number(vizuly2.d3.version.substr(0,1))<4&&console.log("WARNING - Your D3 Library v"+vizuly2.d3.version+" is not compatible with this version of Vizuly.   Please use D3 v4.0.0 or higher."):console.log("WARNING - No D3 library found for vizuly2!  Please load D3 library before instantiating a component."),vizuly2.core={},vizuly2.viz={},vizuly2.viz.layout={},vizuly2.viz.layout.CLUSTERED="CLUSTERED",vizuly2.viz.layout.STACKED="STACKED",vizuly2.viz.layout.OVERLAP="OVERLAP",vizuly2.viz.layout.STREAM="STREAM",vizuly2.svg={},vizuly2.ui={},vizuly2.assets={},vizuly2.core.component=function(t,p){var n,r,d3=vizuly2.d3,a=50;"string"==typeof t&&(t=d3.select(t).node()),p.parent=t,p.id=vizuly2.util.guid(),p.selection=d3.select(t).append("div").attr("id","div_"+p.id).style("width","100%").style("height","100%"),p.initialized=!1,p.size=null;p.styles;var i={},o=["dataTipRenderer"],l=["initialized","validated","measured","updated","styled"];function u(){null==n&&(r=r||p.selection.node().getBoundingClientRect(),n=setTimeout(function(){var t=p.selection.node().getBoundingClientRect();if(f.update&&(t.width!=r.width||t.height!=r.height)){if(f.duration){var e=f.duration();f.duration(0).update().duration(e)}else f.update();p.dispatch}r=t,n=null},a))}Object.getOwnPropertyNames(p.properties).forEach(function(t,e,n){l.push(t+"_change")}),p.events&&0<p.events.length&&p.events.forEach(function(t){l.push(t)}),p.dispatch=d3.dispatch.apply(this,l);var f=function(){var r,a,i;return r=f,i=(a=p).properties,Object.getOwnPropertyNames(i).forEach(function(n,t,e){void 0===a[n]&&(a[n]=i[n],r[n]=function(t){if(!arguments.length)return a[n];var e=a[n];return a[n]=t,a[n]!==e&&a.dispatch.apply(n+"_change",this,[a[n],e]),r})}),f};return p.dispatch.component=f(),f.id=function(){return p.id},f.selection=function(){return p.selection},f.style=function(t,e){return arguments.length<2?i[t]?i[t]:p.styles[t]?p.styles[t]:null:(i[t]=e,f)},f.applyStyles=function(e){return Object.keys(p.styles).forEach(function(t){f.style(t,e[t])}),f},f.clearStyles=function(){return Object.keys(p.styles).forEach(function(t){f.style(t,null)}),f},f.getStyle=function(t,e){return null!=i[t]?"function"==typeof i[t]?i[t].apply(f,e):i[t]:null!=p.styles[t]?"function"==typeof p.styles[t]?p.styles[t].apply(f,e):p.styles[t]:null},f.on=function(t,e){return p.dispatch.on(t,e),f},f.onChange=function(t,e){var n=t.split("."),r=n[0]+"_change"+(1<n.length?"."+n[1]:"");return p.dispatch.on(r,e),f},f.validate=function(){if(0==p.initialized&&p.initialize&&(p.initialize(),p.initialized=!0),!e){var e=[];if(Object.getOwnPropertyNames(p.properties).forEach(function(t){!p[t]&&Number(0!=p[t])&&o.indexOf(t)<0&&e.push(t)}),0<e.length)throw new Error("vizuly2.util.component.validate(): "+e.concat()+" need to be declared");p.dispatch.apply("validated",this)}},f.applyCallbacks=function(t){t.forEach(function(t){p.dispatch.on(t.on,t.callback)})},f.showDataTip=function(t,e,n,r){if(p.dataTipRenderer&&null!=p.dataTipRenderer){var a,i,o=t.getBoundingClientRect(),l=d3.select("body").append("div").attr("class","vz-data-tip").style("display","none"),u=o.left,c=o.top+window.pageYOffset,s=p.dataTipRenderer.apply(f,[l,t,e,n,r,u,c]);if(0!=s){s&&"object"==typeof s&&s.constructor===Array&&(u=s[0],c=s[1]);var d=l.nodes()[0].getBoundingClientRect();a=d.width,i=d.height,l.style("left",u?u+"px":o.left+o.width/2-a/2+"px").style("top",c?c+"px":o.top+window.pageYOffset-i-10+"px"),l.style("display","block")}}},f.removeDataTip=function(){d3.select(".vz-data-tip").remove()},f.parent=function(){return p.parent},f.size=function(){return p.size},f.updateOnResize=function(t,e){return!0===t?(d3.select(window).on("resize.component_"+p.id,u),e&&(a=e)):(d3.select(window).on("resize.component_"+p.id,null),a=50),f},f.destroy=function(){p.selection.remove(),p.selection=null,l.forEach(function(t){p.dispatch.on(t,null)}),p.dispatch=null,p=null},p.dispatch.component},vizuly2.util={},vizuly2.util.getRelativeWidth=function(t,e){if("string"==typeof t&&"%"==t.substr(t.length-1)){var n=Math.min(Number(t.substr(0,t.length-1)),100)/100;return Math.round(e.getBoundingClientRect().width*n)}return Number(t)},vizuly2.util.getRelativeHeight=function(t,e){if("string"==typeof t&&"%"==t.substr(t.length-1)){var n=Math.min(Number(t.substr(0,t.length-1)),100)/100;return Math.round(e.getBoundingClientRect().height*n)}return Number(t)},vizuly2.util.size=function(t,e,n,r){var a={};return r&&(e=vizuly2.util.getRelativeWidth(e,r),n=vizuly2.util.getRelativeHeight(n,r)),a.measuredWidth=e,a.measuredHeight=n,a.width=e-vizuly2.util.measure(t.left,e)-vizuly2.util.measure(t.right,e),a.height=n-vizuly2.util.measure(t.top,n)-vizuly2.util.measure(t.bottom,n),a.top=vizuly2.util.measure(t.top,n),a.left=vizuly2.util.measure(t.left,e),a.bottom=vizuly2.util.measure(t.bottom,n),a.right=vizuly2.util.measure(t.right,e),a},vizuly2.util.getTypedScale=function(t){return"string"==typeof t?vizuly2.d3.scaleBand():t instanceof Date?vizuly2.d3.scaleTime():vizuly2.d3.scaleLinear()},vizuly2.util.measure=function(t,e){if("string"==typeof t&&"%"==t.substr(t.length-1)){var n=Math.min(Number(t.substr(0,t.length-1)),100)/100;return Math.round(e*n)}return Number(t)},vizuly2.util.guid=function(){return"vzxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},vizuly2.util.getDefs=function(t){var e=t.selection().selectAll("svg defs");return e.nodes()&&e.nodes().length<1&&(e=t.selection().select("svg").append("defs")),e},vizuly2.util.createCSSKey=function(t){return"css"+vizuly2.util.cleanString(t)},vizuly2.util.cleanString=function(t){var e=String(t).replace(",","_");return e=(e=e.replace(/[\s+,'+,\.,\(,\),\',\&,\/]/g,"")).toUpperCase()},vizuly2.util.aggregateNest=function(t,u,c){for(var e=t[0];e.values;)e=e.values[0];var a=[];function s(t,e){if(e)for(var n=0;n<a.length;n++){var r=a[n];null!=t[r]&&(t["childProp_"+r]=t[r]),e["childProp_"+r]=t["childProp_"+r]?t["childProp_"+r]:t[r]}}Object.getOwnPropertyNames(e).forEach(function(t){a.push(t)}),function t(e,n){for(var r=0;r<e.length;r++){var a=e[r];if(a.values){t(a.values,a);for(var i=0;i<a.values.length;i++)for(var o=a.values[i],l=0;l<u.length;l++)isNaN(a["agg_"+u[l]])&&(a["agg_"+u[l]]=0),a["agg_"+u[l]]=c(a["agg_"+u[l]],o["agg_"+u[l]])}else for(var l=0;l<u.length;l++)a["agg_"+u[l]]=Number(a[u[l]]),isNaN(a["agg_"+u[l]])&&(a["agg_"+u[l]]=0);s(a,n)}}(t)},vizuly2.util.format_YEAR_Mon_MonDay=function(t){var e=vizuly2.d3.timeFormat(".%L"),n=vizuly2.d3.timeFormat(":%S"),r=vizuly2.d3.timeFormat("%I:%M"),a=vizuly2.d3.timeFormat("%I %p"),i=vizuly2.d3.timeFormat("%a %d"),o=vizuly2.d3.timeFormat("%b %d"),l=vizuly2.d3.timeFormat("%b"),u=vizuly2.d3.timeFormat("%Y");return(vizuly2.d3.timeSecond(t)<t?e:vizuly2.d3.timeMinute(t)<t?n:vizuly2.d3.timeHour(t)<t?r:vizuly2.d3.timeDay(t)<t?a:vizuly2.d3.timeMonth(t)<t?vizuly2.d3.timeWeek(t)<t?i:o:vizuly2.d3.timeYear(t)<t?l:u)(t)},vizuly2.util.stackOffsetBaseline=function(t,e){if(1<(n=t.length)){var n,r=1,a=t[e[0]];for(a.length;r<n;++r)a=t[e[r]]}},vizuly2.util.rgbToHex=function(t){var e=String(t).match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},vizuly2.util.transitionOnEnd=function(t,e){var n=0;t.on("start",function(){n++}).on("end",function(){0==--n&&e()})},vizuly2.util.colorBrightness=function(t){return(299*t.r+587*t.g+114*t.b)/1e3},vizuly2.util.scaleRadial=function(){var e=vizuly2.d3.scaleLinear();function n(t){return Math.sqrt(e(t))}return n.domain=function(t){return arguments.length?(e.domain(t),n):e.domain()},n.nice=function(t){return e.nice(t),n},n.range=function(t){return arguments.length?(e.range(t.map(function(t){return t*t})),n):e.range().map(Math.sqrt)},n.ticks=e.ticks,n.tickFormat=e.tickFormat,n},vizuly2.svg.filter={},vizuly2.svg.filter.dropShadow=function(t,e,n,r){var a=Math.round(100*e)+"_"+Math.round(100*n)+"_"+Math.round(100*r),i=t.id(),o=vizuly2.util.getDefs(t).selectAll("#vz_filter_"+i+"_"+a).data([a]).enter().append("filter").attr("id","vz_filter_"+i+"_"+a).attr("class","vz-svg-filter-dropShadow").attr("width","300%").attr("height","300%");o.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",r),o.append("feOffset").attr("dx",e).attr("dy",n),o.append("feComponentTransfer").append("feFuncA").attr("type","linear").attr("slope",.2);var l=o.append("feMerge");return l.append("feMergeNode"),l.append("feMergeNode").attr("in","SourceGraphic"),"#vz_filter_"+i+"_"+a},vizuly2.svg.gradient={},vizuly2.svg.gradient.blend=function(t,e,n,r){var a,i,o,l,u=String(e).replace("#","")+String(n).replace("#",""),c="vz_gradient_blend_"+t.id()+"_"+u;"horizontal"==r?(a="100%",l=o=i="0%"):(o="100%",l=i=a="0%");var s=vizuly2.util.getDefs(t),d=s.selectAll("#"+c).data([u]);return(d=d.enter().append("linearGradient").attr("id",c).attr("class","vz-svg-gradient-blend").attr("x1",a).attr("x2",i).attr("y1",o).attr("y2",l)).append("stop").attr("offset","0%").attr("stop-color",e),d.append("stop").attr("offset","100%").attr("stop-color",n),d=s.selectAll("#"+c)},vizuly2.svg.gradient.blendMultiple=function(t,e,n,r){var a="";e.forEach(function(t){a+=String(t).replace("#","")+"_"});var i,o,l,u,c="vz_gradient_blend_"+t.id()+"_"+a;"horizontal"==r.toLowerCase()?(i="100%",u=l=o="0%"):(l="100%",u=o=i="0%");var s=vizuly2.util.getDefs(t),d=s.selectAll("#"+c).data([a]);return d=d.enter().append("linearGradient").attr("id",c).attr("class","vz-svg-gradient-blend").attr("x1",i).attr("x2",o).attr("y1",l).attr("y2",u),e.forEach(function(t,e){d.append("stop").attr("offset",100*n[e]+"%").attr("stop-color",t)}),d=s.selectAll("#"+c)},vizuly2.svg.gradient.radialBlend=function(t,e,n,r,a,i,o,l,u){var c=String(r).replace("#","")+String(a).replace("#","")+String(i).replace("%","")+String(o).replace("%",""),s="vz_gradient_radial_blend_"+t.id()+"_"+c,d=vizuly2.util.getDefs(t),p=d.selectAll("#"+s).data([c]);return(p=p.enter().append("radialGradient").attr("id",s).attr("class","vz-svg-gradient-radial-blend").attr("cx",e).attr("cy",n)).append("stop").attr("offset",i).attr("stop-color",r).attr("stop-opacity",void 0===l?1:l),p.append("stop").attr("offset",o).attr("stop-color",a).attr("stop-opacity",void 0===u?1:u),p=d.selectAll("#"+s)},vizuly2.svg.gradient.fade=function(t,e,n,r,a){a||(a=[0,1]),r||(r=[.75,.9]);var i,o,l,u,c=String(e).replace("#",""),s="vz_gradient_fade_"+t.id()+"_"+c;"horizontal"==n.toLowerCase()?(o="100%",u=l=i="0%"):(l="100%",u=o=i="0%");var d=vizuly2.util.getDefs(t),p=d.selectAll("#"+s).data([c]).enter().append("linearGradient").attr("id",s).attr("class","vz-svg-gradient-fade").attr("x1",i).attr("x2",o).attr("y1",l).attr("y2",u);return p.append("stop").attr("offset",100*a[0]+"%").attr("stop-color",e).attr("stop-opacity",r[0]),p.append("stop").attr("offset",100*a[1]+"%").attr("stop-color",e).attr("stop-opacity",r[1]),p=d.selectAll("#"+s)},vizuly2.svg.gradient.radialFade=function(t,e,n,r){r||(r=[0,1]),n||(n=[.75,.9]);var a=String(e).replace("#",""),i="vz_gradient_radial_fade"+t.id()+"_"+a,o=vizuly2.util.getDefs(t),l=o.selectAll("#"+i).data([a]).enter().append("radialGradient").attr("id",i).attr("class","vz-svg-gradient-radial-fade");return l.append("stop").attr("offset",100*r[0]+"%").attr("stop-color",e).attr("stop-opacity",n[0]),l.append("stop").attr("offset",100*r[1]+"%").attr("stop-color",e).attr("stop-opacity",n[1]),l=o.selectAll("#"+i)},vizuly2.svg.gradient.darker=function(t,e,n){var r,a,i,o,l=String(e).replace("#",""),u="vz_gradient_darker_"+t.id()+"_"+l;"horizontal"==n.toLowerCase()?(r="100%",o=i=a="0%"):(i="100%",o=a=r="0%");var c=vizuly2.util.getDefs(t),s=c.selectAll("#"+u).data([l]).enter().append("linearGradient").attr("class","vz-gradient-darker").attr("id",u).attr("x1",r).attr("x2",a).attr("y1",i).attr("y2",o);return s.append("stop").attr("offset","0%").attr("stop-color",e).attr("stop-opacity",.75),s.append("stop").attr("offset","100%").attr("stop-color",vizuly2.d3.rgb(e).darker()).attr("stop-opacity",.9),s=c.selectAll("#"+u)},vizuly2.svg.text={},vizuly2.svg.text.textArcPath=function(t,e){var n={};n.angle=e,n.startAngle=n.angle-179*.0174533,n.endAngle=n.angle+179*.0174533;var r=d3.arc().innerRadius(t).outerRadius(t)(n),a=/[Mm][\d\.\-e,\s]+[Aa][\d\.\-e,\s]+/.exec(r);return a&&(a=a[0]),a},vizuly2.svg.text.wrap=function(t,c,s,d){var p=t.attr("x"),e=t.attr("y");p=!p||isNaN(p)?0:p,e=!e||isNaN(e)?0:e;var f=d/3;t.each(function(){var t,e=d3.select(this),n=c.split(/\s+/).reverse(),r=[],a=0,i=d,o=e.attr("y"),l=1.1*parseFloat(d/2)+f;isNaN(l)&&(l=0);for(var u=e.text(null).append("tspan").attr("x",p).attr("y",o).attr("y",l).style("font-size",d+"px");t=n.pop();)r.push(t),u.text(r.join(" ")),u.node().getComputedTextLength()>s&&(r.pop(),u.text(r.join(" ")),r=[t],u=e.append("tspan").attr("x",p).attr("y",++a*i+l+o).text(t).style("font-size",d+"px"))})};var a={};function i(e,n,r){return function(){var t=r.apply(n,arguments);return t===n?e:t}}function p(t,e){for(var n=[t],r=[];null!=(t=n.pop());)if(r.push(t),(i=t.children)&&(a=i.length))for(var a,i,o=-1;++o<a;)n.push(i[o]);for(;null!=(t=r.pop());)e(t)}function t(t){return t.children}function e(t){return t.value}function n(t,e){return e.value-t.value}function r(t){return a.merge(t.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function o(t,e){return t.value-e.value}function x(t,e){var n=t._pack_next;(t._pack_next=e)._pack_prev=t,(e._pack_next=n)._pack_prev=e}function b(t,e){(t._pack_next=e)._pack_prev=t}function z(t,e){var n=e.x-t.x,r=e.y-t.y,a=t.r+e.r;return n*n+r*r<.999*a*a}function f(t){if((e=t.children)&&(u=e.length)){var e,n,r,a,i,o,l,u,c=1/0,s=-1/0,d=1/0,p=-1/0;if(e.forEach(w),(n=e[0]).x=-n.r,n.y=0,m(n),1<u&&((r=e[1]).x=r.r,r.y=0,m(r),2<u))for(k(n,r,a=e[2]),m(a),x(n,a),x(n._pack_prev=a,r),r=n._pack_next,i=3;i<u;i++){k(n,r,a=e[i]);var f=0,g=1,v=1;for(o=r._pack_next;o!==r;o=o._pack_next,g++)if(z(o,a)){f=1;break}if(1==f)for(l=n._pack_prev;l!==o._pack_prev&&!z(l,a);l=l._pack_prev,v++);f?(g<v||g==v&&r.r<n.r?b(n,r=o):b(n=l,r),i--):(x(n,a),m(r=a))}var h=(c+s)/2,y=(d+p)/2,_=0;for(i=0;i<u;i++)(a=e[i]).x-=h,a.y-=y,_=Math.max(_,a.r+Math.sqrt(a.x*a.x+a.y*a.y));t.r=_,e.forEach(M)}function m(t){c=Math.min(t.x-t.r,c),s=Math.max(t.x+t.r,s),d=Math.min(t.y-t.r,d),p=Math.max(t.y+t.r,p)}}function w(t){t._pack_next=t._pack_prev=t}function M(t){delete t._pack_next,delete t._pack_prev}function k(t,e,n){var r=t.r+n.r,a=e.x-t.x,i=e.y-t.y;if(r&&(a||i)){var o=e.r+n.r,l=a*a+i*i,u=.5+((r*=r)-(o*=o))/(2*l),c=Math.sqrt(Math.max(0,2*o*(r+l)-(r-=l)*r-o*o))/(2*l);n.x=t.x+u*a+c*i,n.y=t.y+u*i-c*a}else n.x=t.x+r,n.y=t.y}a.layout={},a.svg={},a.functor=function(t){return"function"==typeof t?t:function(){return t}},a.merge=function(t){for(var e,n,r,a=t.length,i=-1,o=0;++i<a;)o+=t[i].length;for(n=new Array(o);0<=--a;)for(e=(r=t[a]).length;0<=--e;)n[--o]=r[e];return n},a.rebind=function(t,e){for(var n,r=1,a=arguments.length;++r<a;)t[n=arguments[r]]=i(t,e,e[n]);return t},a.layout.hierarchy=function(){var l=n,u=t,c=e;function s(t){var e,n=[t],r=[];for(t.depth=0;null!=(e=n.pop());)if(r.push(e),(i=u.call(s,e,e.depth))&&(a=i.length)){for(var a,i,o;0<=--a;)n.push(o=i[a]),o.parent=e,o.depth=e.depth+1;c&&(e.value=0),e.children=i}else c&&(e.value=+c.call(s,e,e.depth)||0),delete e.children;return p(t,function(t){var e,n;l&&(e=t.children)&&e.sort(l),c&&(n=t.parent)&&(n.value+=t.value)}),r}return s.sort=function(t){return arguments.length?(l=t,s):l},s.children=function(t){return arguments.length?(u=t,s):u},s.value=function(t){return arguments.length?(c=t,s):c},s.revalue=function(t){return c&&(!function(t,e){var n=[t];for(;null!=(t=n.pop());)if(e(t),(a=t.children)&&(r=a.length))for(var r,a;0<=--r;)n.push(a[r])}(t,function(t){t.children&&(t.value=0)}),p(t,function(t){var e;t.children||(t.value=+c.call(s,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},s},a.layout.pack=function(){var u,t,e,c=a.layout.hierarchy().sort(o),s=0,d=[1,1];function n(t,e){var n=c.call(this,t,e),r=n[0],a=d[0],i=d[1],o=null==u?Math.sqrt:"function"==typeof u?u:function(){return u};if(r.x=r.y=0,p(r,function(t){t.r=+o(t.value)}),p(r,f),s){var l=s*(u?1:Math.max(2*r.r/a,2*r.r/i))/2;p(r,function(t){t.r+=l}),p(r,f),p(r,function(t){t.r-=l})}return function t(e,n,r,a){var i=e.children;e.x=n+=a*e.x;e.y=r+=a*e.y;e.r*=a;if(i)for(var o=-1,l=i.length;++o<l;)t(i[o],n,r,a)}(r,a/2,i/2,u?1:1/Math.max(2*r.r/a,2*r.r/i)),n}return n.size=function(t){return arguments.length?(d=t,n):d},n.radius=function(t){return arguments.length?(u=null==t||"function"==typeof t?t:+t,n):u},n.padding=function(t){return arguments.length?(s=+t,n):s},t=n,e=c,a.rebind(t,e,"sort","children","value"),(t.nodes=t).links=r,t},a.svg.diagonal=function(){var o=function(t){return t.source},l=function(t){return t.target},u=function(t){return[t.x,t.y]};function e(t,e){var n=o.call(this,t,e),r=l.call(this,t,e),a=(n.y+r.y)/2,i=[n,{x:n.x,y:a},{x:r.x,y:a},r];return"M"+(i=i.map(u))[0]+"C"+i[1]+" "+i[2]+" "+i[3]}return e.source=function(t){return arguments.length?(o=a.functor(t),e):o},e.target=function(t){return arguments.length?(l=a.functor(t),e):l},e.projection=function(t){return arguments.length?(u=t,e):u},e},a.svg.diagonal.radial=function(){var t=a.svg.diagonal(),r=function(t){return[t.x,t.y]},e=t.projection;return t.projection=function(t){return arguments.length?e(function(t){return r=t,function(){var t=r.apply(this,arguments),e=t[0],n=t[1]-halfπ;return[e*Math.cos(n),e*Math.sin(n)]}}):r},t},vizuly2.d3v3=a;
 Object.keys(vizuly2).forEach(function (key) { exports[key] = vizuly2[key]});
 Object.defineProperty(exports, '__esModule', { value: true });})));